<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>platforms/web/util.js | 卷心菜笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./logo.jpg">
    <meta name="description" content="基于vue@2.6.14的学习笔记">
    
    <link rel="preload" href="./assets/css/0.styles.74c59701.css" as="style"><link rel="preload" href="./assets/js/app.20317d9d.js" as="script"><link rel="preload" href="./assets/js/2.8a65079d.js" as="script"><link rel="preload" href="./assets/js/90.b3555572.js" as="script"><link rel="prefetch" href="./assets/js/10.3d2f32ec.js"><link rel="prefetch" href="./assets/js/11.132a26b4.js"><link rel="prefetch" href="./assets/js/12.d0193009.js"><link rel="prefetch" href="./assets/js/13.07872830.js"><link rel="prefetch" href="./assets/js/14.96a92186.js"><link rel="prefetch" href="./assets/js/15.89c1bf18.js"><link rel="prefetch" href="./assets/js/16.78f7cadf.js"><link rel="prefetch" href="./assets/js/17.eee5b860.js"><link rel="prefetch" href="./assets/js/18.e94d03e8.js"><link rel="prefetch" href="./assets/js/19.9e73c1ac.js"><link rel="prefetch" href="./assets/js/20.ae18bc8e.js"><link rel="prefetch" href="./assets/js/21.d4a5ba0b.js"><link rel="prefetch" href="./assets/js/22.e7794d4a.js"><link rel="prefetch" href="./assets/js/23.adaee962.js"><link rel="prefetch" href="./assets/js/24.e1df98bf.js"><link rel="prefetch" href="./assets/js/25.c325e810.js"><link rel="prefetch" href="./assets/js/26.c24daaf7.js"><link rel="prefetch" href="./assets/js/27.a3f09949.js"><link rel="prefetch" href="./assets/js/28.123d6383.js"><link rel="prefetch" href="./assets/js/29.04a6e255.js"><link rel="prefetch" href="./assets/js/3.5a34bef2.js"><link rel="prefetch" href="./assets/js/30.f976c0a7.js"><link rel="prefetch" href="./assets/js/31.60d2f4c4.js"><link rel="prefetch" href="./assets/js/32.6b2a5515.js"><link rel="prefetch" href="./assets/js/33.6b80e89d.js"><link rel="prefetch" href="./assets/js/34.ea39628f.js"><link rel="prefetch" href="./assets/js/35.4c14bc3d.js"><link rel="prefetch" href="./assets/js/36.5f2b7559.js"><link rel="prefetch" href="./assets/js/37.57e976da.js"><link rel="prefetch" href="./assets/js/38.191568b8.js"><link rel="prefetch" href="./assets/js/39.f89500e6.js"><link rel="prefetch" href="./assets/js/4.9fb18247.js"><link rel="prefetch" href="./assets/js/40.a45a4a21.js"><link rel="prefetch" href="./assets/js/41.94ece143.js"><link rel="prefetch" href="./assets/js/42.224304d2.js"><link rel="prefetch" href="./assets/js/43.544241cd.js"><link rel="prefetch" href="./assets/js/44.6014c885.js"><link rel="prefetch" href="./assets/js/45.711ad2c3.js"><link rel="prefetch" href="./assets/js/46.19b76064.js"><link rel="prefetch" href="./assets/js/47.0a8f7a4f.js"><link rel="prefetch" href="./assets/js/48.da28ae74.js"><link rel="prefetch" href="./assets/js/49.97615384.js"><link rel="prefetch" href="./assets/js/5.0c239c66.js"><link rel="prefetch" href="./assets/js/50.06bd69e2.js"><link rel="prefetch" href="./assets/js/51.ea943f69.js"><link rel="prefetch" href="./assets/js/52.b4813218.js"><link rel="prefetch" href="./assets/js/53.c1ba1696.js"><link rel="prefetch" href="./assets/js/54.e1d1801c.js"><link rel="prefetch" href="./assets/js/55.ac7cd0ab.js"><link rel="prefetch" href="./assets/js/56.d55c7dcb.js"><link rel="prefetch" href="./assets/js/57.83bbfc8e.js"><link rel="prefetch" href="./assets/js/58.6996ec46.js"><link rel="prefetch" href="./assets/js/59.42c770e8.js"><link rel="prefetch" href="./assets/js/6.0600552c.js"><link rel="prefetch" href="./assets/js/60.919088d2.js"><link rel="prefetch" href="./assets/js/61.455d2404.js"><link rel="prefetch" href="./assets/js/62.40ba97a6.js"><link rel="prefetch" href="./assets/js/63.5b069dba.js"><link rel="prefetch" href="./assets/js/64.512e158a.js"><link rel="prefetch" href="./assets/js/65.6ca1c75b.js"><link rel="prefetch" href="./assets/js/66.0356130d.js"><link rel="prefetch" href="./assets/js/67.93a0d7df.js"><link rel="prefetch" href="./assets/js/68.7e44cc19.js"><link rel="prefetch" href="./assets/js/69.788a4d27.js"><link rel="prefetch" href="./assets/js/7.6346a45d.js"><link rel="prefetch" href="./assets/js/70.571f8a79.js"><link rel="prefetch" href="./assets/js/71.f54eb805.js"><link rel="prefetch" href="./assets/js/72.02cd77d0.js"><link rel="prefetch" href="./assets/js/73.66b6b1d0.js"><link rel="prefetch" href="./assets/js/74.96bf5acc.js"><link rel="prefetch" href="./assets/js/75.1b135bdd.js"><link rel="prefetch" href="./assets/js/76.6ed173f1.js"><link rel="prefetch" href="./assets/js/77.ee856c8d.js"><link rel="prefetch" href="./assets/js/78.b8fc2c30.js"><link rel="prefetch" href="./assets/js/79.7665732d.js"><link rel="prefetch" href="./assets/js/8.6ff51652.js"><link rel="prefetch" href="./assets/js/80.03e59e67.js"><link rel="prefetch" href="./assets/js/81.a6236c2f.js"><link rel="prefetch" href="./assets/js/82.88a5092b.js"><link rel="prefetch" href="./assets/js/83.e93ce178.js"><link rel="prefetch" href="./assets/js/84.8eb37a19.js"><link rel="prefetch" href="./assets/js/85.9d8d91db.js"><link rel="prefetch" href="./assets/js/86.14696351.js"><link rel="prefetch" href="./assets/js/87.51a4cddc.js"><link rel="prefetch" href="./assets/js/88.5cb86311.js"><link rel="prefetch" href="./assets/js/89.11fe5589.js"><link rel="prefetch" href="./assets/js/9.aaa202b7.js">
    <link rel="stylesheet" href="./assets/css/0.styles.74c59701.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">卷心菜笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./main/" class="nav-link">
  正文
</a></div><div class="nav-item"><a href="/./appendix/mergeOptions.html" class="nav-link">
  附录
</a></div><div class="nav-item"><a href="/./util/" class="nav-link router-link-active">
  工具
</a></div><div class="nav-item"><a href="https://github.com/w781223592/vue2.0-note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./main/" class="nav-link">
  正文
</a></div><div class="nav-item"><a href="/./appendix/mergeOptions.html" class="nav-link">
  附录
</a></div><div class="nav-item"><a href="/./util/" class="nav-link router-link-active">
  工具
</a></div><div class="nav-item"><a href="https://github.com/w781223592/vue2.0-note" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>util</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./util/" aria-current="page" class="sidebar-link">工具</a></li><li><a href="/./util/Vue-design.html" class="sidebar-link">Vue整体设计</a></li><li><a href="/./util/shared.html" class="sidebar-link">shared/util.js</a></li><li><a href="/./util/core-util.html" class="sidebar-link">core/util.js</a></li><li><a href="/./util/web-util.html" aria-current="page" class="active sidebar-link">platforms/web/util.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./util/web-util.html#index-js" class="sidebar-link">index.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./util/web-util.html#query" class="sidebar-link">query</a></li></ul></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#element-js" class="sidebar-link">element.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./util/web-util.html#ispretag" class="sidebar-link">isPreTag</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#ishtmltag" class="sidebar-link">isHTMLTag</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#issvg" class="sidebar-link">isSVG</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#isreservedtag" class="sidebar-link">isReservedTag</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#gettagnamespace" class="sidebar-link">getTagNamespace</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#istextinputtype" class="sidebar-link">isTextInputType</a></li></ul></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#attrs-js" class="sidebar-link">attrs.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./util/web-util.html#mustuseprop" class="sidebar-link">mustUseProp</a></li></ul></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#compat-js" class="sidebar-link">compat.js</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#helpers-js" class="sidebar-link">helpers.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./util/web-util.html#pluckmodulefunction" class="sidebar-link">pluckModuleFunction</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#getbindingattr" class="sidebar-link">getBindingAttr</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#getandremoveattr" class="sidebar-link">getAndRemoveAttr</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#getrawbindingattr" class="sidebar-link">getRawBindingAttr</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#addprop" class="sidebar-link">addProp</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#addattr" class="sidebar-link">addAttr</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#addrawattr" class="sidebar-link">addRawAttr</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#rangesetitem" class="sidebar-link">rangeSetItem</a></li><li class="sidebar-sub-header"><a href="/./util/web-util.html#adddirective" class="sidebar-link">addDirective</a></li></ul></li></ul></li><li><a href="/./util/web-compile-util.html" class="sidebar-link">platforms/web/compile/util.js</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="platforms-web-util-js"><a href="#platforms-web-util-js" class="header-anchor">#</a> platforms/web/util.js</h1> <h2 id="index-js"><a href="#index-js" class="header-anchor">#</a> index.js</h2> <h3 id="query"><a href="#query" class="header-anchor">#</a> query</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">query</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> string <span class="token operator">|</span> Element</span><span class="token punctuation">)</span><span class="token operator">:</span> Element <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> el <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> selected <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>selected<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token string">'Cannot find element: '</span> <span class="token operator">+</span> el
      <span class="token punctuation">)</span>
      <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> selected
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> el
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接收el参数，el可能是一个string，也可能是个dom，如果为string时就将el作为选择器去查找dom，如果能找到直接返回，如果找不到就 创建一个空的div再返回，如果是el本身就是dom就直接返回。</p> <h2 id="element-js"><a href="#element-js" class="header-anchor">#</a> element.js</h2> <h3 id="ispretag"><a href="#ispretag" class="header-anchor">#</a> isPreTag</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> isPreTag <span class="token operator">=</span> <span class="token punctuation">(</span>tag<span class="token operator">:</span> <span class="token operator">?</span>string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token parameter">boolean</span> <span class="token operator">=&gt;</span> tag <span class="token operator">===</span> <span class="token string">'pre'</span>
</code></pre></div><p>判断是不是pre标签。</p> <h3 id="ishtmltag"><a href="#ishtmltag" class="header-anchor">#</a> isHTMLTag</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> isHTMLTag <span class="token operator">=</span> <span class="token function">makeMap</span><span class="token punctuation">(</span>
  <span class="token string">'html,body,base,head,link,meta,style,title,'</span> <span class="token operator">+</span>
  <span class="token string">'address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,'</span> <span class="token operator">+</span>
  <span class="token string">'div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,'</span> <span class="token operator">+</span>
  <span class="token string">'a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,'</span> <span class="token operator">+</span>
  <span class="token string">'s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,'</span> <span class="token operator">+</span>
  <span class="token string">'embed,object,param,source,canvas,script,noscript,del,ins,'</span> <span class="token operator">+</span>
  <span class="token string">'caption,col,colgroup,table,thead,tbody,td,th,tr,'</span> <span class="token operator">+</span>
  <span class="token string">'button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,'</span> <span class="token operator">+</span>
  <span class="token string">'output,progress,select,textarea,'</span> <span class="token operator">+</span>
  <span class="token string">'details,dialog,menu,menuitem,summary,'</span> <span class="token operator">+</span>
  <span class="token string">'content,element,shadow,template,blockquote,iframe,tfoot'</span>
<span class="token punctuation">)</span>
</code></pre></div><p>判断是否是html标签。</p> <h3 id="issvg"><a href="#issvg" class="header-anchor">#</a> isSVG</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// this map is intentionally selective, only covering SVG elements that may</span>
<span class="token comment">// contain child elements.</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> isSVG <span class="token operator">=</span> <span class="token function">makeMap</span><span class="token punctuation">(</span>
  <span class="token string">'svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,'</span> <span class="token operator">+</span>
  <span class="token string">'foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,'</span> <span class="token operator">+</span>
  <span class="token string">'polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view'</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span>
<span class="token punctuation">)</span>
</code></pre></div><p>判断是否是SVG标签。</p> <h3 id="isreservedtag"><a href="#isreservedtag" class="header-anchor">#</a> isReservedTag</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> isReservedTag <span class="token operator">=</span> <span class="token punctuation">(</span>tag<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token parameter">boolean</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">isHTMLTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isSVG</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>判断是否是平台保留标签，如果一个标签是html标签或者是svg标签那么就是平台保留标签。</p> <h3 id="gettagnamespace"><a href="#gettagnamespace" class="header-anchor">#</a> getTagNamespace</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getTagNamespace</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tag</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>string <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSVG</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'svg'</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// basic support for MathML</span>
  <span class="token comment">// note it doesn't support other MathML elements being component roots</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">'math'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'math'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>获取标签的命名空间，如果tag是math则返回math，如果是SVG标签的一种则直接返回svg。</p> <h3 id="istextinputtype"><a href="#istextinputtype" class="header-anchor">#</a> isTextInputType</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> isTextInputType <span class="token operator">=</span> <span class="token function">makeMap</span><span class="token punctuation">(</span><span class="token string">'text,number,password,search,email,tel,url'</span><span class="token punctuation">)</span>
</code></pre></div><p>判断input标签的type是否是文本输入类型。比如type为file那就不能输入文本。</p> <h2 id="attrs-js"><a href="#attrs-js" class="header-anchor">#</a> attrs.js</h2> <h3 id="mustuseprop"><a href="#mustuseprop" class="header-anchor">#</a> mustUseProp</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// attributes that should be using props for binding</span>
<span class="token keyword">const</span> acceptValue <span class="token operator">=</span> <span class="token function">makeMap</span><span class="token punctuation">(</span><span class="token string">'input,textarea,option,select,progress'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> mustUseProp <span class="token operator">=</span> <span class="token punctuation">(</span>tag<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token operator">?</span>string<span class="token punctuation">,</span> <span class="token literal-property property">attr</span><span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token parameter">boolean</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">'value'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">acceptValue</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> type <span class="token operator">!==</span> <span class="token string">'button'</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">'selected'</span> <span class="token operator">&amp;&amp;</span> tag <span class="token operator">===</span> <span class="token string">'option'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">'checked'</span> <span class="token operator">&amp;&amp;</span> tag <span class="token operator">===</span> <span class="token string">'input'</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">'muted'</span> <span class="token operator">&amp;&amp;</span> tag <span class="token operator">===</span> <span class="token string">'video'</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个方法是用来检查是否要使用元素原生属性绑定，比如input的value这些，标签原生的属性就不应该被处理成Vue的props。这里acceptValue是判断标签是不是具有原生value属性的这些标签。<br>
第一个判断是value属性，要求元素是acceptValue 中的一个，并且input的type不能是button。第二个判断的是判断option标签的selected属性。第三个判断是input标签的checked属性。第四个判断是video的muted属性。满足任意一种情况都返回true。</p> <h2 id="compat-js"><a href="#compat-js" class="header-anchor">#</a> compat.js</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> inBrowser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'core/util/index'</span>

<span class="token comment">// check whether current browser encodes a char inside attribute values</span>
<span class="token comment">// 检查当前浏览器是否在属性值内编码字符</span>
<span class="token keyword">let</span> div
<span class="token keyword">function</span> <span class="token function">getShouldDecode</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">href</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean <span class="token punctuation">{</span>
  div <span class="token operator">=</span> div <span class="token operator">||</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> href <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;a href=&quot;\n&quot;/&gt;</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div a=&quot;\n&quot;/&gt;</span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">return</span> div<span class="token punctuation">.</span>innerHTML<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'&amp;#10;'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token comment">// #3663: IE encodes newlines inside attribute values while other browsers don't</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> shouldDecodeNewlines <span class="token operator">=</span> inBrowser <span class="token operator">?</span> <span class="token function">getShouldDecode</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token comment">// #6828: chrome encodes content in a[href]</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> shouldDecodeNewlinesForHref <span class="token operator">=</span> inBrowser <span class="token operator">?</span> <span class="token function">getShouldDecode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token boolean">false</span>
</code></pre></div><p>如果有如下代码：</p> <div class="language-html extra-class"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 链接后面加了一个换行符 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.baidu.com
      <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>aaaa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 链接后面加了一个制表符 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.baidu.com <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>bbbb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果我们去获取div的innerHTML值时会发现换行符和制表符被转换为&amp;#10和&amp;#9。而在IE中不仅是a标签有这种问题，所有标签都有问题。Vue中的dom都是通过js来添加，所以这会给Vue的处理带来困扰，但是不是所有类型浏览器和所有版本都有这个问题，所以这里如果a标签有这问题就将shouldDecodeNewlinesForHref常量设置为true，如果其他标签存在这个问题那就把shouldDecodeNewlines设置为true。<br>
当然这是浏览器的问题，非浏览器环境就不需要考虑了。</p> <h2 id="helpers-js"><a href="#helpers-js" class="header-anchor">#</a> helpers.js</h2> <h3 id="pluckmodulefunction"><a href="#pluckmodulefunction" class="header-anchor">#</a> pluckModuleFunction</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> pluckModuleFunction<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">:</span> Function<span class="token operator">&gt;</span> <span class="token punctuation">(</span>
  <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>Object<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> string
<span class="token punctuation">)</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> modules
    <span class="token operator">?</span> modules<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">m</span> <span class="token operator">=&gt;</span> m<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=&gt;</span> _<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>提取modules数组中元素的对应属性。</p> <h3 id="getbindingattr"><a href="#getbindingattr" class="header-anchor">#</a> getBindingAttr</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getBindingAttr</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  getStatic<span class="token operator">?</span><span class="token operator">:</span> boolean</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>string <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dynamicValue <span class="token operator">=</span>
    <span class="token function">getAndRemoveAttr</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token string">':'</span> <span class="token operator">+</span> name<span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token function">getAndRemoveAttr</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token string">'v-bind:'</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dynamicValue <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">parseFilters</span><span class="token punctuation">(</span>dynamicValue<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>getStatic <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> staticValue <span class="token operator">=</span> <span class="token function">getAndRemoveAttr</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>staticValue <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>staticValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>获取绑定的动态属性或静态属性值，并能对动态属性中的过滤器进行处理，对于静态属性如果第三个参数没有传入false的话会在没有获取到动态属性时自动获取静态属性，并对静态属性值做JSON字符串处理。</p> <h3 id="getandremoveattr"><a href="#getandremoveattr" class="header-anchor">#</a> getAndRemoveAttr</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// note: this only removes the attr from the Array (attrsList) so that it</span>
<span class="token comment">// doesn't get processed by processAttrs.</span>
<span class="token comment">// By default it does NOT remove it from the map (attrsMap) because the map is</span>
<span class="token comment">// needed during codegen.</span>
<span class="token comment">// 注意：这只会从Array（attrsList）中删除attr，这样它就不会被processAttrs处理。</span>
<span class="token comment">// 默认情况下，它不会将其从映射（attrsMap）中删除，因为在代码生成期间需要映射</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getAndRemoveAttr</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  removeFromMap<span class="token operator">?</span><span class="token operator">:</span> boolean</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>string <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">=</span> el<span class="token punctuation">.</span>attrsMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> el<span class="token punctuation">.</span>attrsList
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        list<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>removeFromMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">delete</span> el<span class="token punctuation">.</span>attrsMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> val
<span class="token punctuation">}</span>
</code></pre></div><p>获取属性值并在attrsList中删除，但是默认不会删除映射表attrsMap中的属性，触发配置第三个参数为true。</p> <h3 id="getrawbindingattr"><a href="#getrawbindingattr" class="header-anchor">#</a> getRawBindingAttr</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getRawBindingAttr</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> string</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> el<span class="token punctuation">.</span>rawAttrsMap<span class="token punctuation">[</span><span class="token string">':'</span> <span class="token operator">+</span> name<span class="token punctuation">]</span> <span class="token operator">||</span>
    el<span class="token punctuation">.</span>rawAttrsMap<span class="token punctuation">[</span><span class="token string">'v-bind:'</span> <span class="token operator">+</span> name<span class="token punctuation">]</span> <span class="token operator">||</span>
    el<span class="token punctuation">.</span>rawAttrsMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>根据属性名去获取对应属性的描述对象。</p> <h3 id="addprop"><a href="#addprop" class="header-anchor">#</a> addProp</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addProp</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span> range<span class="token operator">?</span><span class="token operator">:</span> Range<span class="token punctuation">,</span> dynamic<span class="token operator">?</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>el<span class="token punctuation">.</span>props <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>props <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">rangeSetItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> dynamic <span class="token punctuation">}</span><span class="token punctuation">,</span> range<span class="token punctuation">)</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span>plain <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>把属性描述对象添加到el.props中，并将el.plain赋值为true。</p> <h3 id="addattr"><a href="#addattr" class="header-anchor">#</a> addAttr</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addAttr</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> any<span class="token punctuation">,</span> range<span class="token operator">?</span><span class="token operator">:</span> Range<span class="token punctuation">,</span> dynamic<span class="token operator">?</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> attrs <span class="token operator">=</span> dynamic
    <span class="token operator">?</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>dynamicAttrs <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>dynamicAttrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>attrs <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>attrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  attrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">rangeSetItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> dynamic <span class="token punctuation">}</span><span class="token punctuation">,</span> range<span class="token punctuation">)</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span>plain <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果dynamic为true则获取el.dynamicAttrs，否则获取el.attrs，然后将一个经过rangeSetItem处理的值push到attrs中。然后将el.plain设置为false。主要是用来将动态属性添加到el.dynamicAttrs中或者将静态属性添加到el.attrs中。</p> <h3 id="addrawattr"><a href="#addrawattr" class="header-anchor">#</a> addRawAttr</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// add a raw attr (use this in preTransforms)</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addRawAttr</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> any<span class="token punctuation">,</span> range<span class="token operator">?</span><span class="token operator">:</span> Range</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  el<span class="token punctuation">.</span>attrsMap<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> value
  el<span class="token punctuation">.</span>attrsList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">rangeSetItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> value <span class="token punctuation">}</span><span class="token punctuation">,</span> range<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为attrsMap添加name对应属性，属性值为value，同时将属性对象添加到attrsList。</p> <h3 id="rangesetitem"><a href="#rangesetitem" class="header-anchor">#</a> rangeSetItem</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">rangeSetItem</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">item</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  range<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> start<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span> end<span class="token operator">?</span><span class="token operator">:</span> number <span class="token punctuation">}</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>start <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span>start <span class="token operator">=</span> range<span class="token punctuation">.</span>start
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>end <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span>end <span class="token operator">=</span> range<span class="token punctuation">.</span>end
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> item
<span class="token punctuation">}</span>
</code></pre></div><p>其实就是根据range值来给item添加start和end、只有在非生产环境有效，因为生产环境是没有range的。</p> <h3 id="adddirective"><a href="#adddirective" class="header-anchor">#</a> addDirective</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">addDirective</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">el</span><span class="token operator">:</span> ASTElement<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">rawName</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">arg</span><span class="token operator">:</span> <span class="token operator">?</span>string<span class="token punctuation">,</span>
  <span class="token literal-property property">isDynamicArg</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
  <span class="token literal-property property">modifiers</span><span class="token operator">:</span> <span class="token operator">?</span>ASTModifiers<span class="token punctuation">,</span>
  range<span class="token operator">?</span><span class="token operator">:</span> Range</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>el<span class="token punctuation">.</span>directives <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>directives <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">rangeSetItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">,</span>
    rawName<span class="token punctuation">,</span>
    value<span class="token punctuation">,</span>
    arg<span class="token punctuation">,</span>
    isDynamicArg<span class="token punctuation">,</span>
    modifiers
  <span class="token punctuation">}</span><span class="token punctuation">,</span> range<span class="token punctuation">)</span><span class="token punctuation">)</span>
  el<span class="token punctuation">.</span>plain <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加指令对象到directives数组，以v-model:show=&quot;value&quot;为例，name则是model，rawName是完整name：v-model；value则是value值；arg则是sho；然后isDynamicArg为false，modifiers也不存在。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./util/core-util.html" class="prev">
        core/util.js
      </a></span> <span class="next"><a href="/./util/web-compile-util.html">
        platforms/web/compile/util.js
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.20317d9d.js" defer></script><script src="./assets/js/2.8a65079d.js" defer></script><script src="./assets/js/90.b3555572.js" defer></script>
  </body>
</html>
